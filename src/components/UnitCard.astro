---
const {
  title,
  image,
  slug,
  shortRole,
  techLevel,
  showTechBadge = true,
  priority = false, // ðŸ‘ˆ NEW: allow marking this card as LCP
} = Astro.props;

// image is like "/units/starfall.png"
// we remove the extension to generate .webp and .avif versions
const baseImage = image.replace(/\.(png|jpg|jpeg|webp|avif)$/i, "");
---

<a href={`/units/${slug}/`} class="unit-card">
  <div class="unit-image-container">
    {showTechBadge && <span class="tech-badge">T{techLevel}</span>}

    <picture>
      <source srcset={`${baseImage}.avif`} type="image/avif" />
      <source srcset={`${baseImage}.webp`} type="image/webp" />
      <img
        src={image}
        alt={title}
        width="161"
        height="161"
        class="unit-thumbnail"
        loading={priority ? "eager" : "lazy"}
        fetchpriority={priority ? "high" : "auto"}
        decoding="async"
      />
    </picture>

    <div class="unit-overlay">
      <div class="unit-name">{title}</div>
      <div class="unit-role">{shortRole}</div>
    </div>
  </div>
</a>
